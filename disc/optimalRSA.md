# Optimal RSA

> Points: 75

> Category: Crypto

## Description

You're aware that textbook RSA is actually insecure, right? So anyway, I applied some padding. For even more security, I'm also using SHA512.

## Attachments

[Download output.txt file](https://imaginary.ml/r/96A4-output.txt)

```
N = 30026988165993332264692204214087846145220842259788459722663793063709989854266401133905288475446633657699992163531251077285227764172076446035823110108966750231078552155776791936090792504232810727562350418446766538847362755164930290809171852367701949039988140887714829232816471710268314188072030870245217078615254674268267664464852145758996406346159287129494958773788146776780988972666107148005992434289916413526240661685861273144661288139977987413076536762591805844788871244445903245434143916925660921016534152770322721172650385197306939399942459668658262531739159594719264834113764254996827458736667266202573242166233
e = 65537
ct.hex() = '5a61e39e2ec5cb8e9744e8cd3a9ff7dd625c26c546e86d12acd56b6180a50913629f3577e35d3f48ea4f9aa725f897f8cf01d5559c8d72c3aba731ad51ea1ed43e709281efba3bb3b5abddb68c1c7e891d246e902b203f41dac279d81b3cfd80302c4b6fdff0c37a4ba03146d4670cec2653d68fe0d8cd495f8049de359ed1058a862cf781b7beacb98eff6ecf9fe3ad4a318508a0475967a3d5d1e074114ea77c19eac4a974dfb8afd126f12bfda09649952a44e22009e58001a8080118a6476904db39c4ba29a58e2dcea24f1740d8eb0745dc6f64d0c117ffece9a88a9d02bb7bdb242ff67b2ae7293e7d069c721610d80f3e418062bdd3d93f738bff8ce9'
```

## Solution

```py
from Crypto.Cipher import PKCS1_OAEP as OAEP
from Crypto.Hash import SHA512

class Key:
    # Emulate pycryptodome's private RSA key
    def __init__(self, n, e, d):
        self.n = n
        self.e = e
        self.d = d

    def _decrypt(self, ciphertext):
        result = pow(ciphertext, self.d, self.n)
        return result

N = 30026988165993332264692204214087846145220842259788459722663793063709989854266401133905288475446633657699992163531251077285227764172076446035823110108966750231078552155776791936090792504232810727562350418446766538847362755164930290809171852367701949039988140887714829232816471710268314188072030870245217078615254674268267664464852145758996406346159287129494958773788146776780988972666107148005992434289916413526240661685861273144661288139977987413076536762591805844788871244445903245434143916925660921016534152770322721172650385197306939399942459668658262531739159594719264834113764254996827458736667266202573242166233
e = 65537

d = 20665231460685769236716315651803076316188425916436496747349248857066624691194771758604515485856004463080404146419786511281763173096378168393423036732759148304355814523615002570844547432914486397851171907069639409313387089872270867397910908787293112432665900279223792021559640203548255842330300141470318615650128123475226890733825032917493536656196781767379352435005272933151192862400355475588786223907294961864100566163832443717545855627593071765253278516562259652156144599378793963441439602499580545058970603270711750854802981124240233680134957365994205917749714731529025147288817354431495272881862770264138784422017

ct = b'Za\xe3\x9e.\xc5\xcb\x8e\x97D\xe8\xcd:\x9f\xf7\xddb\\&\xc5F\xe8m\x12\xac\xd5ka\x80\xa5\t\x13b\x9f5w\xe3]?H\xeaO\x9a\xa7%\xf8\x97\xf8\xcf\x01\xd5U\x9c\x8dr\xc3\xab\xa71\xadQ\xea\x1e\xd4>p\x92\x81\xef\xba;\xb3\xb5\xab\xdd\xb6\x8c\x1c~\x89\x1d$n\x90+ ?A\xda\xc2y\xd8\x1b<\xfd\x800,Ko\xdf\xf0\xc3zK\xa01F\xd4g\x0c\xec&S\xd6\x8f\xe0\xd8\xcdI_\x80I\xde5\x9e\xd1\x05\x8a\x86,\xf7\x81\xb7\xbe\xac\xb9\x8e\xffn\xcf\x9f\xe3\xadJ1\x85\x08\xa0GYg\xa3\xd5\xd1\xe0t\x11N\xa7|\x19\xea\xc4\xa9t\xdf\xb8\xaf\xd1&\xf1+\xfd\xa0\x96I\x95*D\xe2 \t\xe5\x80\x01\xa8\x08\x01\x18\xa6Gi\x04\xdb9\xc4\xba)\xa5\x8e-\xce\xa2O\x17@\xd8\xeb\x07E\xdcod\xd0\xc1\x17\xff\xec\xe9\xa8\x8a\x9d\x02\xbb{\xdb$/\xf6{*\xe7)>}\x06\x9cr\x16\x10\xd8\x0f>A\x80b\xbd\xd3\xd9?s\x8b\xff\x8c\xe9'

key = Key(N, e, d)

cipher = OAEP.new(key, hashAlgo=SHA512)
msg = cipher.decrypt(ct)
print(msg)
```

### Flag

> ictf{single_primes_are_definitely_optimal}
